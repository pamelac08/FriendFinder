<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Survey</title>

    <!-- Bootstrap CSS link -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous"/>
    
    <!--jQuery, Bootstrap JS links  -->
    <script src="https://code.jquery.com/jquery-3.5.0.js" integrity="sha256-r/AaFHrszJtwpe+tHyNi/XCfMxYpbsRg2Uqn0x3s2zc=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>  

    <style>
        #container {
        margin: 40px;
        font-family: Arial, Helvetica, sans-serif;  
        }
        #survey-submit {
            margin-top: 10px;
            width: 100%;
        }
        #match-photo {
            min-width: 300px;
            max-width: 450px;
            min-height: 400px;
            max-height: 600px;
        }
        select {
            max-width: 33%;
            margin-bottom: 15px;
        }
        #header {
            text-align: center;
            text-shadow: black 2px 2px;
            font-size: 4rem;
        }
    </style>
</head>

<body>

    <div id="container">
      <h1 id="header">Survey Questions</h1>
        <hr/>
      <form id="name-form">
        <div class="form-group">
          <label for="name"><h4>Name (required)</h4></label> <br />
          <input type="text" class="form-control" id="name" aria-describedby="emailHelp" required/>
        </div>
        <div class="form-group">
          <label for="photo"><h4>Link to Photo (required)</h4></label> <br/>
          <input type="text" class="form-control" id="photo" required />
        </div>
      </form>
        <hr/>

      <h4>Question 1</h4>
      <h6>I like to take charge.</h6>

      <select class="form-control form-control-sm" id="q1">
        <option value="">Select your answer</option>
        <option value="1">1 (strongly disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (strongly agree)</option>
      </select>

      <h4>Question 2</h4>
      <h6>I like to solve complex problems.</h6>

      <select class="form-control form-control-sm" id="q2">
        <option value="">Select your answer</option>
        <option value="1">1 (strongly disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (strongly agree)</option>
      </select>

      <h4>Question 3</h4>
      <h6>I make friends easily.</h6>

      <select class="form-control form-control-sm" id="q3">
        <option value="">Select your answer</option>
        <option value="1">1 (strongly disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (strongly agree)</option>
      </select>

      <h4>Question 4</h4>
      <h6>I dislike being the center of attention.</h6>

      <select class="form-control form-control-sm" id="q4">
        <option value="">Select your answer</option>
        <option value="1">1 (strongly disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (strongly agree)</option>
      </select>

      <h4>Question 5</h4>
      <h6>I enjoy being spontaneous.</h6>

      <select class="form-control form-control-sm" id="q5">
        <option value="">Select your answer</option>
        <option value="1">1 (strongly disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (strongly agree)</option>
      </select>

      <h4>Question 6</h4>
      <h6>I generally believe others have good intentions.</h6>

      <select class="form-control form-control-sm" id="q6">
        <option value="">Select your answer</option>
        <option value="1">1 (strongly disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (strongly agree)</option>
      </select>

      <h4>Question 7</h4>
      <h6>I stick to the rules.</h6>

      <select class="form-control form-control-sm" id="q7">
        <option value="">Select your answer</option>
        <option value="1">1 (strongly disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (strongly agree)</option>
      </select>

      <h4>Question 8</h4>
      <h6>I usually avoid confrontations.</h6>

      <select class="form-control form-control-sm" id="q8">
        <option value="">Select your answer</option>
        <option value="1">1 (strongly disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (strongly agree)</option>
      </select>

      <h4>Question 9</h4>
      <h6>I prefer solitude most of the time.</h6>

      <select class="form-control form-control-sm" id="q9">
        <option value="">Select your answer</option>
        <option value="1">1 (strongly disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (strongly agree)</option>
      </select>

      <h4>Question 10</h4>
      <h6>I have many passions and interests.</h6>

      <select class="form-control form-control-sm" id="q10">
        <option value="">Select your answer</option>
        <option value="1">1 (strongly disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (strongly agree)</option>
      </select>

      <button type="button" class="btn btn-primary btn-lg" id="survey-submit">Submit</button>
    

    <hr/>
    <a href="/">Home</a> | 
    <a href="/api/friends" target="_blank">API Friends List</a> | 
    <a href="https://github.com/pamelac08/FriendFinder" target="_blank">GitHub Repo</a>
</div>

    <!-- modal for closest match pop-up once API returns data-->
    <div class="modal" tabindex="-1" role="dialog" id="match-modal">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="match-name">Modal title</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
                <div class="text-center">
                    <img id="match-photo" alt="via.placeholder.com/450">
                </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>



<script>
    $(document).ready(function() {   

        // when user clicks submit: the data inputs will be read and sent to the server via the post request and the input fields will be cleared
        $("#survey-submit").on("click", function (event) {
            event.preventDefault();
        
            var score1 = parseInt($("#q1 option:selected").val());
            var score2 = parseInt($("#q2 option:selected").val()); 
            var score3 = parseInt($("#q3 option:selected").val());
            var score4 = parseInt($("#q4 option:selected").val());
            var score5 = parseInt($("#q5 option:selected").val());
            var score6 = parseInt($("#q6 option:selected").val());
            var score7 = parseInt($("#q7 option:selected").val());
            var score8 = parseInt($("#q8 option:selected").val());
            var score9 = parseInt($("#q9 option:selected").val());
            var score10 = parseInt($("#q10 option:selected").val());

            var totalScore = [score1, score2, score3, score4, score5, score6, score7, score8, score9, score10];

            var newUser = {
            name: $("#name").val(),
            photo: $("#photo").val().trim(),
            scores: totalScore
            };
            
            window.location.hash = "header";
            $("#name").val("");
            $("#photo").val(""),
            $("#q1").val("");
            $("#q2").val("");
            $("#q3").val("");
            $("#q4").val("");
            $("#q5").val("");
            $("#q6").val("");
            $("#q7").val("");
            $("#q8").val("");
            $("#q9").val("");
            $("#q10").val("");

            $.post("/api/friends", newUser)

                .then(function (data) {
                    // console.log("response: ", JSON.stringify(data));

                    $("#match-name").html(data.matchName);
                    $("#match-photo").attr("src", data.matchImage);
                    
                    // console.log("data.matchName", data.matchName);

                    $("#match-modal").modal("show");

                });
        });
    });

</script>

</body>
</html>
